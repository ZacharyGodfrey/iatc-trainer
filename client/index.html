<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="An app for recording practice sessions for the IATC Round 1 competition format">
    <title>IATC Trainer</title>
    <link rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfkBwcUIzDtqVv8AAAA7klEQVRIx+2UPRKCMBCFv+gBqOAS/BTcwhk8gBVclKSAGTquYG9JZ+HEgswoEEK0oWGrRzbvZUneLhyxf5wXKxkX7jwtewNuvHi4BRMUA5U1VzGgSLboGkVqzaYmm7jp0nFG4pLYpjsl/OirEv50q8SULoiIEE48kcipJ/QrDQ0FYoFbg0cJiaYmhx5NR2yqiWjQaBpCwgluDY7MzpgOTX/y9qyefQvEuDr/heKrbDv+3EJNvrxV/0uU83dQPz2jtDlBeRtJrnlReVlZurpBbTaT3OrHtXbOfAw/DpTy34Eyjo2SwJoJqFZqO2LneAPBQX6E4ZXh/QAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wNy0wN1QyMDozNTo0MSswMDowMAfDeWoAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDctMDdUMjA6MzU6NDErMDA6MDB2nsHWAAAAAElFTkSuQmCC">
    <style>
      [x-cloak] { display: none !important; }
    </style>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="//unpkg.com/alpinejs" defer></script>
  </head>
  <body class="flex flex-col min-h-screen text-base font-mono text-neutral-800 bg-neutral-200">
    <header class="bg-white py-4 text-center">
      <section class="max-w-4xl mx-auto px-4">
        <h1 class="text-2xl font-semibold">IATC Trainer</h1>
      </section>
    </header>

    <main class="grow w-full max-w-4xl mx-auto p-4" x-data="{ sessions: [] }" x-init="sessions = await getSessions()">
      <section class="bg-white mb-4 p-4 rounded">
        <p>You can submit a practice session using <a target="_blank" href="https://docs.google.com/forms/d/e/1FAIpQLSfWmTWE95z_oxA_13GvSSKS8aA8vyD3XHSGV0y52O27bCZkyA/viewform?usp=sf_link">this Google Form</a>.</p>

        <p>You can view the raw data in <a target="_blank" href="https://docs.google.com/spreadsheets/d/1wZQt0AIFaokmbVYYIVV65dx5Ty5xxE0xvJc-moip-tY/edit?usp=sharing">this Google Spreadsheet</a>.</p>
      </section>

      <section class="bg-white mb-4 p-4 rounded" x-cloak>
        <p x-show="sessions.length === 0">No practice sessions have been submitted yet.</p>

        <table class="border-collapse border border-neutral-800" x-show="sessions.length > 0">
          <thead>
            <th class="border border-neutral-800">Session</th>
            <th class="border border-neutral-800">Total Match Score</th>
            <th class="border border-neutral-800">Average Match Score</th>
            <th class="border border-neutral-800">Big Axe Total Score</th>
            <th class="border border-neutral-800">Match Scores</th>
          </thead>
          <tbody>
            <template x-for="x in sessions" :key="x.timestamp">
              <tr>
                <td class="border border-neutral-800 text-center" x-text="x.timestamp"></td>
                <td class="border border-neutral-800 text-center" x-text="x.totalMatchScore"></td>
                <td class="border border-neutral-800 text-center" x-text="x.averageMatchScore"></td>
                <td class="border border-neutral-800 text-center" x-text="x.bigAxe.total"></td>
                <td class="border border-neutral-800 text-center">
                  <ol class="list-inside list-decimal">
                    <li x-text="x.match1.total"></li>
                    <li x-text="x.match2.total"></li>
                    <li x-text="x.match3.total"></li>
                    <li x-text="x.match4.total"></li>
                    <li x-text="x.match5.total"></li>
                  </ol>
                </td>
              </tr>
            </template>
          </tbody>
        </table>
      </section>
    </main>

    <footer class="text-neutral-100 bg-neutral-700 py-4 text-center">
      <section class="max-w-4xl mx-auto px-4">
        <p>Created by Zachary Godfrey.</p>
      </section>
    </footer>

    <script>
      const getSessions = async () => {
        const sessions = await fetch('/api').then(res => res.json());

        console.log(sessions);

        return sessions;
      };
    </script>
  </body>
</html>